import{R as L,f as b,j as e,S as P,a as $,H as G}from"./Header-CkPsEBDC.js";const k=new Map,_=(s,a)=>{if(!s)return;(Array.isArray(s)?s:Object.values(s)).forEach(r=>{const t=r.id;k.set(t,{id:r.id,label:r.label,category:r.category,group:a}),r.children&&Object.keys(r.children).length>0&&_(r.children,a)})};_(b["0_0"].children,b["0_0"].primaryGroup);_(b["0_2"].children,b["0_2"].primaryGroup);_(b["0_1"].children,b["0_1"].primaryGroup);const{useState:N,useMemo:S,useCallback:A,useEffect:z}=L,y=({items:s,handleFilterChange:a,selectedFilters:l,level:r=0})=>{if(!s||s.length===0)return null;const t=Array.isArray(s)?s:Object.values(s);return e.jsx("div",{className:"nested-list space-y-1",children:t.map(c=>e.jsx(V,{item:c,handleFilterChange:a,selectedFilters:l,level:r},c.id))})},V=({item:s,handleFilterChange:a,selectedFilters:l,level:r})=>{const t=s.id,c=s.children?Object.values(s.children):[],d=c.length>0,n=l.has(t),[h,o]=N(!1),m=D=>{D.preventDefault(),o(I=>!I)},g={paddingLeft:r>0?`${r*1.25}rem`:"0"},C=(k.get(t)||{}).group;return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center group hover:var(--cruk-pink) p-1 -m-1 rounded transition duration-100",style:g,children:[d?e.jsx("button",{type:"button",className:`transition-transform duration-200 w-4 h-4 flex items-center justify-center text-gray-500 hover:var(--cruk-pink)  mr-1 ${h?"rotate-90":""}`,onClick:m,"aria-expanded":h,children:e.jsx("svg",{className:"w-3 h-3 transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}):e.jsx("span",{className:"w-4 h-4 mr-1"}),e.jsx("input",{type:"checkbox",id:t,className:"rounded text-[var(--cruk-pink)] border-gray-300 focus:ring-[var(--cruk-pink)] mr-2 w-4 h-4 cursor-pointer","data-filter-group":C,checked:n,onChange:()=>a(t)}),e.jsxs("label",{htmlFor:t,className:"text-gray-700 select-none flex-grow cursor-pointer text-sm",children:[s.label,e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.count,")"]})]})]}),d&&h&&e.jsx(y,{items:c,handleFilterChange:a,selectedFilters:l,level:r+1})]})},H=({selectedFilters:s,handleFilterChange:a})=>{const l=S(()=>Array.from(s).map(t=>{const c=k.get(t);if(!c)return null;const n=c.group==="cancer-type"?"bg-[var(--cruk-white)] text-[var(--cruk-pink)] border border-[var(--cruk-pink)]":"bg-[var(--cruk-white)] text-[var(--cruk-blue)] border border-[var(--cruk-blue)]";return{fullId:t,label:c.label,category:c.category,chipClass:n}}).filter(Boolean),[s]);return l.length===0?null:e.jsxs("div",{id:"selected-filters-area",className:"bg-white rounded-b-xl shadow-lg border-b border-l border-r border-gray-300 p-3 transition duration-300 ease-in-out",children:[e.jsx("div",{id:"filter-chip-list",className:"flex items-start flex-wrap gap-2 text-sm",children:l.map(r=>e.jsxs("div",{className:`filter-chip inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold shadow-sm ${r.chipClass}`,children:[e.jsxs("span",{className:"mr-1 opacity-75",children:[r.category,":"]}),e.jsx("span",{className:"font-bold",children:r.label}),e.jsx("button",{type:"button",className:"ml-2 h-4 w-4 rounded-full flex items-center justify-center hover:bg-white hover:bg-opacity-50 transition duration-150",onClick:()=>a(r.fullId),"aria-label":`Remove filter ${r.label}`,children:e.jsx("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},r.fullId))}),e.jsx("p",{id:"logic-summary",className:"text-xs text-gray-500 mt-2 px-1",children:"Logic: (Cancer Filters are OR-ed) AND (Data Type Filters are AND-ed) AND (Accessibility Filters are AND-ed)"})]})},K=()=>{const[s,a]=N(null),[l,r]=N(new Set),[t,c]=N(""),[d,n]=N(null),[h,o]=N(!1),m=S(()=>Array.from(k.values()),[]);z(()=>{if(!t||t.length<4){n(null),o(!1);return}const i=setTimeout(()=>{o(!0);const x={cancer:"cancer-type",data:"data-type",access:"access"}[s];if(!x){n(null),o(!1);return}const w=t.toLowerCase(),u=m.filter(j=>j.group!==x?!1:j.label.toLowerCase().includes(w)),v=new Set(u.map(j=>j.id));n(v),o(!1)},300);return()=>clearTimeout(i)},[t,s,m]);const g=A((i,p)=>{if(!i)return null;if(!p)return i;const x={};return(Array.isArray(i)?i:Object.values(i)).forEach(u=>{const v=g(u.children,p),j=p.has(u.id),F=v&&Object.keys(v).length>0;if(j||F){const R={...u};v&&(R.children=v),x[u.id]=R}}),Object.keys(x).length>0?x:null},[]),f=S(()=>{let i=0,p=0,x=0;return l.forEach(w=>{const u=k.get(w);u&&(u.group==="cancer-type"?i++:u.group==="data-type"?p++:u.group==="access"&&x++)}),{total:l.size,cancer:i,data:p,access:x}},[l]),C=A(i=>{r(p=>{const x=new Set(p);return x.has(i)?x.delete(i):x.add(i),x})},[]),D=A(()=>{r(new Set),a(null),c("")},[]),I=A(()=>{console.log(`Executing search with ${f.total} filters.`),a(null)},[f.total]),B=()=>{const i={handleFilterChange:C,selectedFilters:l,searchTerm:t,setSearchTerm:c,filteredIds:d,isSearching:h,pruneHierarchy:g};switch(s){case"cancer":return e.jsx(U,{...i});case"data":return e.jsx(W,{...i});case"access":return e.jsx(q,{...i});default:return null}},M=i=>`nav-button w-full px-4 py-3 text-left text-lg font-medium border-l-4 transition duration-150 ${s===i?"bg-gray-100 text-[var(--cruk-pink)] border-[var(--cruk-pink)]":"text-gray-600 hover:bg-gray-50 border-transparent"}`,O=f.total===0;return e.jsx("div",{className:"p-2 sm:p-8 bg-gray-50",children:e.jsx("div",{id:"filter-container",className:"w-full flex flex-col",children:e.jsxs("div",{className:"flex flex-col md:flex-row bg-white rounded-xl shadow-lg border border-gray-300 overflow-hidden",children:[e.jsxs("div",{id:"filter-navbar",className:"flex flex-col flex-shrink-0 w-full md:w-1/4 bg-gray-50 border-b md:border-b-0 md:border-r border-gray-200",children:[e.jsx("h2",{className:"p-4 text-3xl sm:text-4xl font-bold text-[var(--cruk-blue)]",children:"Study Filters"}),e.jsxs("button",{onClick:()=>{a("cancer"),c("")},className:M("cancer"),children:["Cancer Type ",e.jsxs("span",{className:"text-sm opacity-80 font-normal ml-2",children:["(",f.cancer," Selected)"]})]}),e.jsxs("button",{onClick:()=>{a("data"),c("")},className:M("data"),children:["Data Type ",e.jsxs("span",{className:"text-sm opacity-80 font-normal ml-2",children:["(",f.data," Selected)"]})]}),e.jsxs("button",{onClick:()=>{a("access"),c("")},className:M("access"),children:["Accessibility ",e.jsxs("span",{className:"text-sm opacity-80 font-normal ml-2",children:["(",f.access," Selected)"]})]}),e.jsx("button",{onClick:D,className:"px-4 py-2 font-medium text-sm text-gray-500 hover:var(--cruk-pink) hover:text-[var(--cruk-pink)] transition duration-150 bg-white rounded-lg shadow-sm border border-gray-300",children:"Clear Filters"}),e.jsxs("button",{onClick:I,className:`bg-[var(--cruk-pink)] text-white font-bold py-3 px-8 rounded-lg shadow-md transition duration-150 ${O?"opacity-50 cursor-not-allowed":"hover:opacity-90"}`,disabled:O,children:["Find Studies (",f.total,")"]})]}),e.jsxs("div",{className:"flex-grow w-full md:w-3/4 p-0",children:[e.jsx(H,{selectedFilters:l,handleFilterChange:C}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s&&B(),e.jsx(P,{})]})]})]})})})},T=({searchTerm:s,setSearchTerm:a,isSearching:l,placeholder:r})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"search",placeholder:r||"Search terms (min 4 characters)...",className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-[var(--cruk-pink)] focus:border-[var(--cruk-pink)] text-sm",value:s,onChange:t=>a(t.target.value)}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l?e.jsxs("svg",{className:"animate-spin h-5 w-5 text-[var(--cruk-pink)]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})})]}),s&&s.length<4&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please enter at least 4 characters to search."})]}),U=({handleFilterChange:s,selectedFilters:a,searchTerm:l,setSearchTerm:r,filteredIds:t,isSearching:c,pruneHierarchy:d})=>{const n=b["0_0"].children,h=d(n["0_0_0"].children,t),o=d(n["0_0_1"].children,t),m=d(n["0_0_2"].children,t);return e.jsx("div",{id:"cancer-type-panel",className:"md:col-span-3 bg-white rounded-xl overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-3 sm:p-4 text-gray-600 flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Cancer Type Selection"}),e.jsx(T,{searchTerm:l,setSearchTerm:r,isSearching:c,placeholder:"Search Cancer/ICD-O terms"}),e.jsxs("p",{className:"text-sm italic text-gray-500 mb-3",children:["Filter by official pathology classifications (ICD-O) or patient-friendly CRUK terminology. (",e.jsx("span",{className:"text-[var(--cruk-pink)] font-semibold",children:"OR Logic"}),")"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 border p-3 rounded-lg bg-gray-100",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-3 border-b pb-1",children:"ICD-O Classification"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-inner border border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2",children:"Topography"}),e.jsx("div",{id:"icdo-topography-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:h,handleFilterChange:s,selectedFilters:a})})]}),e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-inner border border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2",children:"Histology"}),e.jsx("div",{id:"icdo-histology-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:o,handleFilterChange:s,selectedFilters:a})})]})]})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-3 border-b pb-1",children:"CRUK Cancer Terms"}),e.jsx("div",{id:"cruk-terms-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:m,handleFilterChange:s,selectedFilters:a})})]})]})]})})},W=({handleFilterChange:s,selectedFilters:a,searchTerm:l,setSearchTerm:r,filteredIds:t,isSearching:c,pruneHierarchy:d})=>{const n=b["0_2"].children,h=d(n["0_2_0"].children,t),o=d(n["0_2_1"].children,t),m=d(n["0_2_2"].children,t),g=d(n["0_2_3"].children,t);return e.jsx("div",{id:"data-type-panel",className:"md:col-span-3 bg-white rounded-xl overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-3 sm:p-4 text-gray-600 flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Data Type Selection"}),e.jsx(T,{searchTerm:l,setSearchTerm:r,isSearching:c,placeholder:"Search data types"}),e.jsxs("p",{className:"text-sm italic text-gray-500 mb-2",children:["Select one or more modalities to include in your search. (",e.jsx("span",{className:"text-blue-800 font-semibold",children:"AND Logic"}),")"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"Biobank Samples"}),e.jsx("div",{id:"biobank-samples-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:h,handleFilterChange:s,selectedFilters:a})})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"In Vitro Studies"}),e.jsx("div",{id:"invitro-studies-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:o,handleFilterChange:s,selectedFilters:a})})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"Animal Studies"}),e.jsx("div",{id:"animal-studies-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:m,handleFilterChange:s,selectedFilters:a})})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"Patient Studies"}),e.jsx("div",{id:"patient-studies-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(y,{items:g,handleFilterChange:s,selectedFilters:a})})]})]})]})})},q=({handleFilterChange:s,selectedFilters:a,searchTerm:l,setSearchTerm:r,filteredIds:t,isSearching:c,pruneHierarchy:d})=>{const n=Object.values(b["0_1"].children),h=S(()=>t?n.filter(o=>t.has(o.id)):n,[n,t]);return e.jsx("div",{id:"accessibility-panel",className:"md:col-span-3 bg-white rounded-xl overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-3 sm:p-4 text-gray-600 flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Accessibility and Source"}),e.jsx(T,{searchTerm:l,setSearchTerm:r,isSearching:c,placeholder:"Search accessibility/source terms"}),e.jsxs("p",{className:"text-sm italic text-gray-500 mb-2",children:["Filter by data access level and source. (",e.jsx("span",{className:"text-blue-800 font-semibold",children:"AND Logic"}),")"]}),e.jsx("div",{className:"h-32 overflow-y-auto pr-2 border p-3 rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[h.map(o=>{const m=o.id,g=a.has(m);return e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:m,className:"rounded text-[var(--cruk-pink)] border-gray-300 focus:ring-[var(--cruk-pink)] mr-2 w-4 h-4 cursor-pointer","data-filter-group":"access",checked:g,onChange:()=>s(m)}),e.jsxs("label",{htmlFor:m,className:"text-gray-700 select-none flex-grow cursor-pointer text-sm",children:[o.label," ",e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",o.count,")"]})]})]},o.id)}),c===!1&&l.length>=4&&h.length===0&&e.jsxs("p",{className:"text-sm text-gray-500",children:['No results found for "',l,'".']})]})})]})})};function E(s,a){const l=document.getElementById(s);l?$.createRoot(l).render(e.jsx(L.StrictMode,{children:a})):console.error(`Target element '${s}' not found in the DOM. Cannot render component.`)}E("header",e.jsx(G,{}));E("vert_navbar",e.jsx(K,{}));
