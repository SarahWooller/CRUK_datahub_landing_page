import{a as k,f as o,j as e,R as A,H as S}from"./Header-Dufssz_U.js";import{S as _}from"./StudiesSection-qXXqkrKj.js";const f=new Map,j=(s,t)=>{if(!s)return;(Array.isArray(s)?s:Object.values(s)).forEach(r=>{const l=r.id;f.set(l,{id:r.id,label:r.label,category:r.category,group:t}),r.children&&Object.keys(r.children).length>0&&j(r.children,t)})};j(o["0_0"].children,o["0_0"].primaryGroup);j(o["0_2"].children,o["0_2"].primaryGroup);j(o["0_1"].children,o["0_1"].primaryGroup);const{useState:N,useMemo:C,useCallback:v}=k,d=({items:s,handleFilterChange:t,selectedFilters:a,level:r=0})=>{if(!s||s.length===0)return null;const l=Array.isArray(s)?s:Object.values(s);return e.jsx("div",{className:"nested-list space-y-1",children:l.map(c=>e.jsx(D,{item:c,handleFilterChange:t,selectedFilters:a,level:r},c.id))})},D=({item:s,handleFilterChange:t,selectedFilters:a,level:r})=>{const l=s.id,c=s.children?Object.values(s.children):[],h=c.length>0,p=a.has(l),[u,b]=N(!1),g=y=>{y.preventDefault(),b(x=>!x)},n={paddingLeft:r>0?`${r*1.25}rem`:"0"},i=(f.get(l)||{}).group;return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center group hover:var(--cruk-pink) p-1 -m-1 rounded transition duration-100",style:n,children:[h?e.jsx("button",{type:"button",className:`transition-transform duration-200 w-4 h-4 flex items-center justify-center text-gray-500 hover:var(--cruk-pink)  mr-1 ${u?"rotate-90":""}`,onClick:g,"aria-expanded":u,children:e.jsx("svg",{className:"w-3 h-3 transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}):e.jsx("span",{className:"w-4 h-4 mr-1"}),e.jsx("input",{type:"checkbox",id:l,className:"rounded text-[var(--cruk-pink)] border-gray-300 focus:ring-[var(--cruk-pink)] mr-2 w-4 h-4 cursor-pointer","data-filter-group":i,checked:p,onChange:()=>t(l)}),e.jsxs("label",{htmlFor:l,className:"text-gray-700 select-none flex-grow cursor-pointer text-sm",children:[s.label,e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.count,")"]})]})]}),h&&u&&e.jsx(d,{items:c,handleFilterChange:t,selectedFilters:a,level:r+1})]})},I=({selectedFilters:s,handleFilterChange:t})=>{const a=C(()=>Array.from(s).map(l=>{const c=f.get(l);if(!c)return null;const p=c.group==="cancer-type"?"bg-[var(--cruk-white)] text-[var(--cruk-pink)] border border-[var(--cruk-pink)]":"bg-[var(--cruk-white)] text-[var(--cruk-blue)] border border-[var(--cruk-blue)]";return{fullId:l,label:c.label,category:c.category,chipClass:p}}).filter(Boolean),[s]);return a.length===0?null:e.jsxs("div",{id:"selected-filters-area",className:"bg-white rounded-b-xl shadow-lg border-b border-l border-r border-gray-300 p-3 transition duration-300 ease-in-out",children:[e.jsx("div",{id:"filter-chip-list",className:"flex items-start flex-wrap gap-2 text-sm",children:a.map(r=>e.jsxs("div",{className:`filter-chip inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold shadow-sm ${r.chipClass}`,children:[e.jsxs("span",{className:"mr-1 opacity-75",children:[r.category,":"]}),e.jsx("span",{className:"font-bold",children:r.label}),e.jsx("button",{type:"button",className:"ml-2 h-4 w-4 rounded-full flex items-center justify-center hover:bg-white hover:bg-opacity-50 transition duration-150",onClick:()=>t(r.fullId),"aria-label":`Remove filter ${r.label}`,children:e.jsx("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},r.fullId))}),e.jsx("p",{id:"logic-summary",className:"text-xs text-gray-500 mt-2 px-1",children:"Logic: (Cancer Filters are OR-ed) AND (Data Type Filters are AND-ed) AND (Accessibility Filters are AND-ed)"})]})},R=()=>{const[s,t]=N(null),[a,r]=N(new Set),l=C(()=>{let n=0,m=0,i=0;return a.forEach(y=>{const x=f.get(y);x&&(x.group==="cancer-type"?n++:x.group==="data-type"?m++:x.group==="access"&&i++)}),{total:a.size,cancer:n,data:m,access:i}},[a]),c=v(n=>{r(m=>{const i=new Set(m);return i.has(n)?i.delete(n):i.add(n),i})},[]),h=v(()=>{r(new Set),t(null)},[]),p=v(()=>{console.log(`Executing search with ${l.total} filters.`),t(null)},[l.total]),u=()=>{const n={handleFilterChange:c,selectedFilters:a};switch(s){case"cancer":return e.jsx(T,{...n});case"data":return e.jsx(L,{...n});case"access":return e.jsx(O,{...n});default:return null}},b=n=>`nav-button flex-1 px-4 py-3 text-lg font-medium border-b-4 sm:border-b-0 sm:border-r transition duration-150 ${s===n?"bg-gray-100 text-[var(--cruk-pink)] border-[var(--cruk-pink)]":"text-gray-600 hover:bg-gray-50 border-transparent"}`,g=l.total===0;return e.jsx("div",{className:"p-2 sm:p-8 bg-gray-50",children:e.jsxs("div",{id:"filter-container",className:"w-full flex flex-col",children:[e.jsx("h2",{className:"section-heading",children:"Study Filters"}),e.jsxs("div",{id:"filter-navbar",className:"flex flex-col sm:flex-row bg-white rounded-t-xl shadow-lg border-b border-gray-300 overflow-hidden",children:[e.jsxs("button",{onClick:()=>t("cancer"),className:b("cancer"),children:["Cancer Type ",e.jsxs("span",{className:"text-xs opacity-80 font-normal ml-2",children:["(",l.cancer," Selected)"]})]}),e.jsxs("button",{onClick:()=>t("data"),className:b("data"),children:["Data Type ",e.jsxs("span",{className:"text-xs opacity-80 font-normal ml-2",children:["(",l.data," Selected)"]})]}),e.jsxs("button",{onClick:()=>t("access"),className:b("access"),children:["Accessibility ",e.jsxs("span",{className:"text-xs opacity-80 font-normal ml-2",children:["(",l.access," Selected)"]})]}),e.jsxs("div",{className:"flex-shrink-0 flex sm:flex-row flex-col",children:[e.jsx("button",{onClick:h,className:"px-4 py-3 font-medium text-sm sm:text-lg text-gray-500 hover:var(--cruk-pink) hover:text-[var(--cruk-pink)] transition duration-150 border-t sm:border-t-0 sm:border-l",children:"Clear Filters"}),e.jsxs("button",{onClick:p,className:`bg-[var(--cruk-pink)] text-white font-bold py-3 px-8 shadow-md transition duration-150 ${g?"opacity-50 cursor-not-allowed":"hover:var(--cruk-pink)"}`,disabled:g,children:["Find Studies (",l.total,")"]})]})]}),e.jsx(I,{selectedFilters:a,handleFilterChange:c}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:u()})]})})},T=({handleFilterChange:s,selectedFilters:t})=>{const a=o["0_0"].children,r=a["0_0_0"].children,l=a["0_0_1"].children,c=a["0_0_2"].children;return e.jsx("div",{id:"cancer-type-panel",className:"md:col-span-3 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-3 sm:p-4 text-gray-600 flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Cancer Filters"}),e.jsxs("p",{className:"text-sm italic text-gray-500 mb-3",children:["Filter by official pathology classifications (ICD-O) or patient-friendly CRUK terminology. (",e.jsx("span",{className:"text-[var(--cruk-pink)] font-semibold",children:"OR Logic"}),")"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 border p-3 rounded-lg bg-gray-100",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-3 border-b pb-1",children:"ICD-O Classification"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-inner border border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2",children:"Topography"}),e.jsx("div",{id:"icdo-topography-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:r,handleFilterChange:s,selectedFilters:t})})]}),e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-inner border border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2",children:"Histology"}),e.jsx("div",{id:"icdo-histology-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:l,handleFilterChange:s,selectedFilters:t})})]})]})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-3 border-b pb-1",children:"CRUK Cancer Terms"}),e.jsx("div",{id:"cruk-terms-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:c,handleFilterChange:s,selectedFilters:t})})]})]})]})})},L=({handleFilterChange:s,selectedFilters:t})=>{const a=o["0_2"].children;return e.jsx("div",{id:"data-type-panel",className:"md:col-span-3 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-3 sm:p-4 text-gray-600 flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Data Type Selection"}),e.jsxs("p",{className:"text-sm italic text-gray-500 mb-2",children:["Select one or more modalities to include in your search. (",e.jsx("span",{className:"text-blue-800 font-semibold",children:"AND Logic"}),")"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"Biobank Samples"}),e.jsx("div",{id:"biobank-samples-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:a["0_2_0"].children,handleFilterChange:s,selectedFilters:t})})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"In Vitro Studies"}),e.jsx("div",{id:"invitro-studies-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:a["0_2_1"].children,handleFilterChange:s,selectedFilters:t})})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"Animal Studies"}),e.jsx("div",{id:"animal-studies-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:a["0_2_2"].children,handleFilterChange:s,selectedFilters:t})})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-2 border-b pb-1",children:"Patient Studies"}),e.jsx("div",{id:"patient-studies-list",className:"h-40 overflow-y-auto space-y-1 text-sm pr-2",children:e.jsx(d,{items:a["0_2_3"].children,handleFilterChange:s,selectedFilters:t})})]})]})]})})},O=({handleFilterChange:s,selectedFilters:t})=>{const a=Object.values(o["0_1"].children);return e.jsx("div",{id:"accessibility-panel",className:"md:col-span-3 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-3 sm:p-4 text-gray-600 flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Accessibility"}),e.jsxs("p",{className:"text-sm italic text-gray-500 mb-2",children:["Filter by data access level and source. (",e.jsx("span",{className:"text-blue-800 font-semibold",children:"AND Logic"}),")"]}),e.jsx("div",{className:"h-32 overflow-y-auto pr-2 border p-3 rounded-lg",children:e.jsx("div",{className:"space-y-2",children:a.map(r=>{const l=r.id,c=t.has(l);return e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:l,className:"rounded text-[var(--cruk-pink)] border-gray-300 focus:ring-[var(--cruk-pink)] mr-2 w-4 h-4 cursor-pointer","data-filter-group":"access",checked:c,onChange:()=>s(l)}),e.jsxs("label",{htmlFor:l,className:"text-gray-700 select-none flex-grow cursor-pointer text-sm",children:[r.label," ",e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",r.count,")"]})]})]},r.id)})})})]})})};function w(s,t){const a=document.getElementById(s);a?A.createRoot(a).render(e.jsx(k.StrictMode,{children:t})):console.error(`Target element '${s}' not found in the DOM. Cannot render component.`)}w("header",e.jsx(S,{}));w("filter_navbar",e.jsx(R,{}));w("studies",e.jsx(_,{}));
